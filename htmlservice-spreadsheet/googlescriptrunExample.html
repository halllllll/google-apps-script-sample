<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <h1>Formã®å†…å®¹ã‚’gsã§å—ã‘å–ã£ã¦sheetã«åæ˜ </h1>
      <form id="form" enctype="multipart/form-data">
			<ul>
        <li>
          <label for="weekday">æ›œæ—¥ </label>
          <div>
            <select id="weekday" name="weekday"> 
              <option value="Mon" selected="selected">æœˆ</option>
              <option value="Tue">ç«</option>
              <option value="Wed">æ°´</option>
              <option value="Thu">æœ¨</option>
              <option value="Fri">é‡‘</option>
              <option value="Sat">åœŸ</option>
            </select>
	  	    </div>
        </li> 
        <li>
          <label for="period">æ™‚é™ </label>
          <div>
            <select id="period" name="period"> 
              <option value="1" selected="selected">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </div> 
        </li>
        <li>
          <label for="subject">æ•™ç§‘ </label>
          <div>
            <select id="subject" name="subject"> 
              <option value="kokugo" selected="selected">å›½èª</option>
              <option value="sansu">ç®—æ•°</option>
              <option value="rika">ç†ç§‘</option>
              <option value="syakai">ç¤¾ä¼š</option>
              <option value="ongaku">éŸ³æ¥½</option>
              <option value="gakkatsu">å­¦æ´»</option>
              <option value="sogo">ç·åˆ</option>
              <option value="taiiku">ä½“è‚²</option>
              <option value="zuko">å›³å·¥</option>
              <option value="hoken">ä¿å¥</option>
              <option value="kateika">å®¶åº­ç§‘</option>
              <option value="doutoku">é“å¾³</option>
              <option value="gig">GIG</option>
            </select>
          </div> 
        </li>
        <li>
          <label for="class_URL">URL </label>
          <div>
            <input type="text" id="input_URL" name="input_URL" pattern="^(|http(|s)://[0-9a-zA-Z/#&?%\.\-\+_=]+)$" placeholder="not requiredã ã‚ˆï½"> 
          </div> 
        </li>
      </li>	
      <input id="submitForm" class="button_text" type="submit" name="submit" value="Sheetã«åæ˜ ã™ã‚‹ã‚ˆã€œ")>
      </ul>
	  </form>
    <script  type="text/javascript">      
      function submitFunc(event) {
        const formData = new FormData(form);
        // ãªãœã‹formdataã ã¨SSã«é€ã‚Œãªã„ï¼Ÿã®ã§ã›ã£ã‹ãformdataã«ã—ãŸã‘ã©æ‰‹ã§æŠ½å‡ºã™ã‚‹
        const weekday = formData.get("weekday");
        const period = formData.get("period");
        const subject = formData.get("subject");
        const url = formData.get("input_URL");

        google.script.run.withSuccessHandler(function(){
          google.script.host.close();
          alert("åæ˜ ã—ã¾ã—ãŸï¼ï¼ï¼ğŸ˜¤");
        }).withFailureHandler(function(){
          alert("å¤±æ•—ã—ã¾ã—ãŸ...ğŸ¥ºğŸ¥ºğŸ¥º");
        }).setData(weekday, period, subject, url);
        event.preventDefault();
      }
      const form = document.getElementById("form");
      form.addEventListener("submit", submitFunc);
    </script>
  </body>
</html>
